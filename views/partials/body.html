<!-- /.row -->

<div class="row">
	<div class="col-lg-12">

		<div class="table-responsive" id="docket_table_div">

		</div>
		<!-- /.table-responsive -->
	</div>
	<!-- /.col-lg-4 (nested) -->
	<div id="refreshLabel" style="margin-left:87%;color:#1E5799;"></div>
	<div class="col-lg-12" id="timeLineData">

		<!-- /.panel Timeline -->
		<div class="panel panel-default">
			<div class="panel-heading">
				<i class="fa fa-clock-o fa-fw"></i> Timeline
			</div>
			<!-- /.panel-heading -->
			<div class="panel-body">
				<ul class="timeline">
					{{#each auditRecords}}
					<li class="{{ternary @index " " "timeline-inverted "}}" data-toggle="modal" data-target="#timemodel" onclick="showRowDetailsTimeLine('{{this._id}}');">
						{{#if_eq this.status "success"}}
						<div class="timeline-badge success">
							<i class="fa fa-thumbs-up"></i>
						</div>
						{{/if_eq}} {{#if_eq this.status "failure"}}
						<div class="timeline-badge danger">
							X<i class="timeline-badge danger"></i>
						</div>
						{{/if_eq}}
						<!-- <% if(doc.status !=='success' || doc.status !=='failure') { %>
													<div class="timeline-badge warning">
														<b>!</b><i class="timeline-badge warning"></i>
													</div>
												<% } %> -->
						<div class="timeline-panel">
							<div class="timeline-heading">
								<h4 class="timeline-title">{{this.name}} Event</h4>
								<p>
									<small class="text-muted"><i class="fa fa-time"></i>
										Time : {{this.eventDateTime}} </small>
								</p>
							</div>
							<div class="timeline-body">
								<p>
									{{this.details}}
								</p>
							</div>
						</div>
					</li>
					{{/ each}}
				</ul>
			</div>
			<!-- /.panel-body -->
		</div>
		<!-- /.panel Timeline-->
	</div>
	<!-- /.col-lg-8 (nested) -->
</div>
<!-- /.row -->

<!-- /.row -->

<!-- /#page-wrapper -->

<!-- Modal -->
<div class="modal fade" id="timemodel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

	<div class="modal-dialog" style="margin-left: 10%; margin-right: 0; width: 80%;">

		<div class="modal-content">
			<!-- <div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-hidden="true">&times;</button>
				<h4 class="modal-title" id="myModalLabel">Audit Details</h4>
			</div> -->
			<div class="modal-body" id="docket_event_details"></div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<!-- <button type="button" class="btn btn-primary">Save changes</button> -->
			</div>
		</div>
		<!-- /.modal-content -->
	</div>
	<!-- /.modal-dialog -->
</div>
</div>
<script type="text/javascript">
	function showRowDetailsTimeLine(id) {
		$.ajax({
			type: 'GET',
			url: '/rowDetails?id=' + id,
			success: function(response) {
				if (response.status === 401) {
					window.location.href = "/login"
				} else {
					$("#docket_event_details").html(response);
				}
			},
			error: function(err) {
				alertify.error(err);
			}
		});
	}

	setTimeout(function() {
		$("#refreshLabel").html("Updating timeline...").fadeIn();
		$.ajax({
			type: 'GET',
			url: '/audit',
			success: function(response) {
				if (response.status === 401) {
					window.location.href = "/login"
				} else {
					$("#wrapper").html(response);
					$("#refreshLabel").fadeOut();
				}
			},
			error: function(err) {
				alertify.error(err);
			}
		});
	}, 90000);
</script>